---
title: 应用更新
summary: 内部市场应用更新，本地控制台应用更新
toc: true
---

本文阐述应用更新概念，并教您如何将本地及内部市场应用进行更新升级。

## 一、应用更新

对于从云市安装回来的应用，如果分享应用的用户对其分享到云市的应用有小版本更新（其应用下组件版本有更新），我们会在控制台对您的安装回来的应用进行更新提醒，如果您更新了内部市场应用后，我们会在您安装到本地控制台的应用进行应用升级提醒。
流程图如下：

<img src="https://static.goodrain.com/images/docs/3.7.1/app_upgrade.png" width='100%' />
 

具体流程如下：

1.安装云市应用，您可以从云市安装，亦可从内部市场安装，在创建应用中选择`从应用市场安装`，并搜索您想要安装的应用，安装即可。


<img src="https://static.goodrain.com/images/docs/3.7.1/app_install.gif" width='100%' />


2.当其他用户对其分享到云市的应用进行小版本升级（即将其应用下的组件进行版本升级），您会在点击`云端同步`的时候显示出来，提示您当前应用是否可更新，如果可更新，您可以通过`云端更新`或`更新新版本`,即可对当前内部市场应用进行更新操作。


<img src="https://static.goodrain.com/images/docs/3.7.1/app_update.gif" width='100%' />


3.当您对内部市场应用进行更新升级后，在您本地控制台安装的应用还未进行升级，在您查看应用详情时，我们会对您的应用进行查询是否可更新，如果可更新，会对您的应用进行升级提醒，以便您的操作


<img src="https://static.goodrain.com/images/docs/3.7.1/app_upgrade.gif" width='100%' />


## 二、判断依据(实现原理)

当用户将其租户下的一组应用进行打包分享的时候，我们会对其组内每个组件进行service_key的赋值操作（一个随机的uuid），对应用的update_version进行累加操作，并在云市进行存储，从云市同步到内部市场的时候，将该应用的数据及其下面的所有组件信息在内部市场中进行存储，通过其中的字段update_version进行小版本判断，其中update_version在进行分享操作时，每次分享都会对其值进行累加，在同步到内部市场的时候在服务构建源中存储update_version以进行更新判断，并通过返回的service_key与service_id进行唯一组件的判断，防止在存储依赖关系时关系紊乱；
从市场安装回来的应用判断更新依据是通过该组件的部署版本与服务构建源中的组件部署版本进行比对，以此来判断该组件是否可更新。

内部市场的应用更新是将云市应用重新同步到内部市场中（即将云市应用的数据在内部市场更新）
本地控制台的应用更新是将内部市场的应用数据在本地更新，并向数据中心发送请求，拉取最新的镜像进行部署。
