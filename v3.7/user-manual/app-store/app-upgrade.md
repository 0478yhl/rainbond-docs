---
title: 应用更新
summary: 内部应用市场应用更新，本地控制台应用更新
toc: true
---

本文阐述应用更新概念，并教您如何将本地及内部应用市场应用进行更新升级。

## 一、应用更新

对于从公有云市安装回来的应用，如果分享应用的用户对其分享到公有云市的应用有小版本更新（其应用下组件版本有更新），我们会在控制台对您的安装回来的应用进行更新提醒，如果您更新了内部应用市场应用后，我们会在您安装到本地控制台的应用进行应用升级提醒。
流程图如下：

<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/3.7.1/app_upgrade.png" width='100%' />
 

具体流程如下：

1.安装公有云市应用，您可以从公有云市安装，亦可从内部应用市场安装，在创建应用中选择`从应用市场安装`，并搜索您想要安装的应用，安装即可。


<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/3.7.1/app_install.gif" width='100%' />


2.当其他用户对其分享到公有云市的应用进行小版本升级（即将其应用下的组件进行版本升级），您会在点击`云端同步`的时候显示出来，提示您当前应用是否可更新，如果可更新，您可以通过`云端更新`或`更新新版本`,即可对当前内部应用市场应用进行更新操作。


<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/3.7.1/app_update.gif" width='100%' />


3.当您对内部应用市场应用进行更新升级后，在您本地控制台安装的应用还未进行升级，在您查看应用详情时，我们会对您的应用进行查询是否可更新，如果可更新，会对您的应用进行升级提醒，以便您的操作


<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/3.7.1/app_upgrade.gif" width='100%' />


## 二、判断依据(实现原理)

当用户将其租户下的一组应用进行打包分享的时候，我们会对其组内每个组件进行标识操作，对应用的小版本进行累加操作，并在公有云市进行存储，从公有云市同步到内部应用市场的时候，将该应用的数据及其下面的所有组件信息在内部应用市场中进行存储，通过其中小版本和内部应用市场存储的该应用的小版本进行判断该内部应用市场中的应用是否可更新，其中小版本在进行分享操作时，每次分享都会对其值进行累加，在同步到内部应用市场的时候在服务构建源中存储小版本以进行更新判断，并通过返回的应用数据中的字段进行唯一组件的判断，防止在存储依赖关系时关系紊乱；
从市场安装回来的应用判断更新依据是通过该组件版本与服务构建源中的组件版本进行比对，以此来判断该组件是否可更新。

内部应用市场的应用更新是将公有云市应用重新同步到内部市场中（即将云市应用的数据在内部市场更新）
本地控制台的应用更新是将内部市场的应用数据在本地更新，并向数据中心发送请求，拉取最新的镜像进行部署。

## 三、版本定义
应用大版本：一组应用打包， 在分享的过程中，用户会手动输入一个版本号，即为该分享到公有云市应用的大版本，大版本的变化根据用户的改变而定，当用户再次分享该应用，并改变了大版本时，分享到公有云市场的应用和之前分享的不是同一个，例如：mysql的5.5.46；

应用小版本：该分享到公有云市的应用，会生成一个小版本保存到公有云市中，每次用户对该应用进行重新分享时，小版本会进行数值累加；

组件版本：一组应用下的每个组件，当其每次重新部署时，会生成一个部署版本，即为该组件的版本